
<%= link_to("Add Workout", new_event_path) %>
<%= link_to("My Workouts", my_events_path) %>
<%= paginate @events.order(created_at: :desc) %>

<% if current_user %>
  <% @events.each do |event| %>
    <%= render partial: "event", locals:{event: event} %>

    <p></p>
    <!-- event_id of current user to compare to event_ids of the events we are cycling through -->
      <% if current_user && event.event_users.where(user_id:current_user.id).first %>
        <%= link_to("map", event_path(event)) %>
        
         <h5>You have joined this Workout</h5>

      <% else %>
            <%= form_for event.event_users.new do |f| %>
                    <%= f.hidden_field :event_id, value: event.id %>
                    <%= f.submit "Join" %><br> 
                    <%= event.users.length %>
            <% end %>
            <%= link_to("map", event_path(event)) %>

      <% end %>
      <%= link_to("Add Workout", new_event_path) %>
      <%= link_to("My Workouts", my_events_path) %>
  <% end %>
<% else %>
  <h4> Please sign in to join a workout </h4>
  <div>
  <% @events.each do |event| %>
      <strong>Workout:</strong> <%=event.event_name %>- <%=event.description %>, <%=event.difficulty %><br>
      <strong>Date:</strong> <%=event.date %><br>
      <strong>Time: </strong><%=event.time %>
      <p></p>
    </div>
     
  <% end %>
<% end %>

<br>

<%= paginate @events.order(created_at: :desc) %>
